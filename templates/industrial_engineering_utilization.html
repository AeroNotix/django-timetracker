{% extends "base.html" %}
{% block header %}
<link href="{{ STATIC_URL }}indeng.css" type="text/css" rel="stylesheet" />
<link href="{{ STATIC_URL }}jquery.jqplot.min.css" type="text/css" rel="stylesheet" />
{% endblock header %}
{% block menubar %}
{% include "includes/get_nav.html" %}
{% endblock menubar %}

{% block content %}
<div class="container">
  <h3>Industrial Engineering Reports: Utilization</h3>
  <table>
    <tr>
      <td>Team:
        <select id="team">
          {% for team in teams %}
          <option value="{{ team.0 }}">{{ team.1 }}</option>
          {% endfor %}
        </select>
        <input id="year" type="text" value="{{ year }}" />
        {{ months|safe }}
    </tr>
  </table>
</div>
<div id="chart1"></div>
<div></div>
{% endblock content %}
{% block additional_javascript %}
<script type="text/javascript" src="{{ STATIC_URL}}jquery/jquery.jqplot.min.js"></script>
<script type="text/javascript" src="{{ STATIC_URL}}jquery/jqplot.categoryAxisRenderer.min.js"></script>
<script type="text/javascript" src="{{ STATIC_URL}}jquery/jqplot.pointLabels.min.js"></script>
<script type="text/javascript" src="{{ STATIC_URL}}jquery/jqplot.barRenderer.min.js"></script>
<script type="text/javascript" src="{{ STATIC_URL}}js/indeng.js"></script>
<script>
$(function() {
    $("#month").val("{{ selected_month }}");
    $("#team").val("{{ selected_team }}");
})
var CONFIG = {
   "REFRESH_URL": "{% url 'timetracker.industrial_engineering.views.utilization' %}"
};


$(document).ready(function(){
    var plotdata_util = [
        {% for key, value in utlztn_all.items %}
            {{ value.util.percent }},
        {% endfor %}
        ],
        plotdata_effi = [
        {% for key, value in utlztn_all.items %}
            {{ value.effi.percent }},
        {% endfor %}
        ],
        plotdata_avai = [
        {% for key, value in utlztn_all.items %}
            {{ value.avai.percent }},
        {% endfor %}
        ],
        plotdata_util_target = [
        {% for key, value in utlztn_all.items %}
            {{ value.util.target }},
        {% endfor %}
        ],
        plotdata_effi_target = [
        {% for key, value in utlztn_all.items %}
            {{ value.effi.target }},
        {% endfor %}
        ],
        plotdata_avai_target = [
        {% for key, value in utlztn_all.items %}
            {{ value.avai.target }},
        {% endfor %}
        ];

    var ticks = [{% for item in dates %}
                 "{{ item }}",
                 {% endfor %}];

    var plot1 = $.jqplot('chart1', [plotdata_util, plotdata_effi,
                                    plotdata_avai, plotdata_util_target,
                                    plotdata_effi_target, plotdata_avai_target], {
        seriesDefaults:{
            rendererOptions: {fillToZero: true}
        },
        series:[
            {label: 'Efficiency',
             renderer:$.jqplot.BarRenderer},
            {label: 'Utilization',
             renderer:$.jqplot.BarRenderer},
            {label: 'Availiability',
             renderer:$.jqplot.BarRenderer},
            {label: 'Efficiency Target',
             showMarker: false},
            {label: 'Utilization Target',
             showMarker: false},
            {label: 'Availability Target',
             showMarker: false}
        ],
        legend: {
            show: true,
            placement: 'outsideGrid'
        },
        axes: {
            xaxis: {
                renderer: $.jqplot.CategoryAxisRenderer,
                ticks: ticks
            },
            yaxis: {
                tickOptions: {formatString: '%d%'}
            }
        }
    });
});
</script>



{% endblock additional_javascript %}
