

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>View Module &mdash; Timetracker 1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Timetracker 1 documentation" href="index.html" />
    <link rel="prev" title="Welcome to Timetracker’s documentation!" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to Timetracker’s documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Timetracker 1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-timetracker.views">
<span id="view-module"></span><h1>View Module<a class="headerlink" href="#module-timetracker.views" title="Permalink to this headline">¶</a></h1>
<p>Views which are mapped from the URL objects in urls.py</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">platform:</th><td class="field-body">All</td>
</tr>
<tr class="field-even field"><th class="field-name">synopsis:</th><td class="field-body">Module which contains view functions that are mapped from urls</td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="timetracker.views.add_change_user">
<tt class="descclassname">timetracker.views.</tt><tt class="descname">add_change_user</tt><big>(</big><em>request</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/timetracker/views.html#add_change_user"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#timetracker.views.add_change_user" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the view for changing/adding users</p>
<p>This is the view which generates the page to add/edit/change/remove users,
the view first gets the user object from the database, then checks it&#8217;s
user_type. If it&#8217;s an administrator, their authorization table entry is
found then used to create a select box and it&#8217;s HTML markup. Then pushed
to the template. If it&#8217;s a team leader, their manager&#8217;s authorization
table is used instead.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>request</strong> &#8211; Automatically passed contains a map of the httprequest</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">HttpResponse object back to the browser.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="timetracker.views.admin_view">
<tt class="descclassname">timetracker.views.</tt><tt class="descname">admin_view</tt><big>(</big><em>request</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/timetracker/views.html#admin_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#timetracker.views.admin_view" title="Permalink to this definition">¶</a></dt>
<dd><p>This view checks to see if the user logged in is either a team leader or
an administrator. If the user is an administrator, their authorization
table entry is found, iterated over to create a select box and it&#8217;s HTML
markup, sent to the template. If the user is a team leader, then <em>their</em>
manager&#8217;s authorization table entry is found and used instead. This is to
enable team leaders to view and edit the team in which they are on but
also make it so that we don&#8217;t explicitly have to duplicate the
authorization table linking the team leader with their team.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>request</strong> &#8211; Automatically passed contains a map of the httprequest</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">HttpResponse object back to the browser.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="timetracker.views.ajax">
<tt class="descclassname">timetracker.views.</tt><tt class="descname">ajax</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="_modules/timetracker/views.html#ajax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#timetracker.views.ajax" title="Permalink to this definition">¶</a></dt>
<dd><p>Ajax request handler, dispatches to specific ajax functions depending
on what json gets sent.</p>
<blockquote>
<div><p>Any additional ajax views should be added to the ajax_funcs map, this will
allow the dispatch function to be used. Future revisions could have a kind
of decorator which could be applied to functions to mutate some global map
of ajax dispatch functions. For now, however, just add them into the map.</p>
<p>The idea for this is that on the client-side call you would construct your
javascript call with something like the below (using jQuery):</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre> <span class="nx">$</span><span class="p">.</span><span class="nx">ajaxSetup</span><span class="p">({</span>
     <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
     <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;/ajax/&#39;</span><span class="p">,</span>
     <span class="nx">dataType</span><span class="o">:</span> <span class="s1">&#39;json&#39;</span>
 <span class="p">});</span>

 <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
     <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
         <span class="nx">form</span><span class="o">:</span> <span class="s1">&#39;functionName&#39;</span><span class="p">,</span>
         <span class="nx">data</span><span class="o">:</span> <span class="s1">&#39;data&#39;</span>
     <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
</div></blockquote>
<p>Using this method, this allows us to construct a single view url and have
all ajax requests come through here. This is highly advantagious because
then we don&#8217;t have to create a url map and construct views to handle that
specific call. We just have some server-side map and route through there.</p>
<p>The lookup and dispatch works like this:</p>
<ol class="arabic simple">
<li>Request comes through.</li>
<li>Request gets sent to the ajax view due to the client-side call making a
request to the url mapped to this view.</li>
<li>The form type is detected in the json data sent along with the call.</li>
<li>This string is then pulled out of the dict, executed and it&#8217;s response
sent back to the browser.</li>
</ol>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>request</strong> &#8211; Automatically passed contains a map of the httprequest</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">HttpResponse object back to the browser.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="timetracker.views.edit_profile">
<tt class="descclassname">timetracker.views.</tt><tt class="descname">edit_profile</tt><big>(</big><em>request</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/timetracker/views.html#edit_profile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#timetracker.views.edit_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>View for sending the user to the edit profile page</p>
<p>This view is a simple set of fields which allow all kinds of users to edit
pieces of information about their profile, currently it allows uers to
edit their name and their password.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>request</strong> &#8211; Automatically passed contains a map of the httprequest</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">HttpResponse object back to the browser.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="timetracker.views.explain">
<tt class="descclassname">timetracker.views.</tt><tt class="descname">explain</tt><big>(</big><em>request</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/timetracker/views.html#explain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#timetracker.views.explain" title="Permalink to this definition">¶</a></dt>
<dd><p>Renders the Balance explanation page</p>
<p>This page renders a simple template to show the users how their balance is
calculated. This view takes the user object, retrieves a couple of fields,
which are user.shiftlength and the associated values with that datetime
objects, constructs a string with them and passes it to the template as
the users &#8216;shiftlength&#8217; attribute. It then takes the count of working
days in the database so that the user has an idea of how many days they
have tracked altogether. Then it calculates their total balance and pushes
all these strings into the template.</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param request:</th><td class="field-body">Automatically passed contains a map of the httprequest</td>
</tr>
<tr class="field-even field"><th class="field-name">return:</th><td class="field-body">HttpResponse object back to the browser.</td>
</tr>
</tbody>
</table>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="timetracker.views.forgot_pass">
<tt class="descclassname">timetracker.views.</tt><tt class="descname">forgot_pass</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="_modules/timetracker/views.html#forgot_pass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#timetracker.views.forgot_pass" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple view for resetting a user&#8217;s password</p>
<p>This view has a dual function. The first function is to simply render the
initial page which has a field and the themed markup. On this page a user
can enter their e-mail address and then click submit to have their
password sent to them.</p>
<p>The second function of this page is to respond to the change password
request. In the html markup of the &#8216;forgotpass.html&#8217; page you will see
that the intention is to have the page post to the same URL which this
page was rendered from. If the request contains POST information then we
retrieve that user from the database, construct an e-mail based on that
and send their password to them. Finally, we redirect to the login page.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>request</strong> &#8211; Automatically passed contains a map of the httprequest</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">HttpResponse object back to the browser.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="timetracker.views.holiday_planning">
<tt class="descclassname">timetracker.views.</tt><tt class="descname">holiday_planning</tt><big>(</big><em>request</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/timetracker/views.html#holiday_planning"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#timetracker.views.holiday_planning" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the full holiday table for all employees under a manager</p>
<p>First we find the user object and find whether or not that user is a team
leader or not. If they are a team leader, which set a boolean flag to show
the template what kind of user is logged in. This is so that the team
leaders are not able to view certain things (e.g. Job Codes).</p>
<p>If the admin/tl tries to access the holiday page before any users have
been assigned to them, then we just throw them back to the main page. This
is doubly ensuring that they can&#8217;t access what would otherwise be a
completely borked page.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>request</strong> &#8211; Automatically passed contains a map of the httprequest</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">HttpResponse object back to the browser.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="timetracker.views.index">
<tt class="descclassname">timetracker.views.</tt><tt class="descname">index</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="_modules/timetracker/views.html#index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#timetracker.views.index" title="Permalink to this definition">¶</a></dt>
<dd><p>This function serves the base login page. TODO: Make this view check
to see if the user is already logged in and if so, redirect.</p>
<p>This function shouldn&#8217;t be directly called, it&#8217;s invocation is automatic</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param request:</th><td class="field-body">Automatically passed. Contains a map of the httprequest</td>
</tr>
<tr class="field-even field"><th class="field-name">return:</th><td class="field-body">A HttpResponse object which is then passed to the browser</td>
</tr>
</tbody>
</table>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="timetracker.views.login">
<tt class="descclassname">timetracker.views.</tt><tt class="descname">login</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="_modules/timetracker/views.html#login"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#timetracker.views.login" title="Permalink to this definition">¶</a></dt>
<dd><p>This function logs the user in, directly adding the session id to
a database entry. This function is invoked from the url mapped in urls.py.
The url is POSTed to, and should contain two fields, the use_name and the
pass word field. This is then pulled from the database and matched
against, what the user supplied. If they match, the user is then checked
to see what <em>kind</em> of user their are, if they are ADMIN or TEAML they will
be sent to the administrator view. Else they will be sent to the user
page.</p>
<p>This function shouldn&#8217;t be directly called, it&#8217;s invocation is automatic
from the url mappings.</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param request:</th><td class="field-body">Automatically passed. Contains a map of the httprequest</td>
</tr>
<tr class="field-even field"><th class="field-name">return:</th><td class="field-body">A HttpResponse object which is then passed to the browser</td>
</tr>
</tbody>
</table>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="timetracker.views.logout">
<tt class="descclassname">timetracker.views.</tt><tt class="descname">logout</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="_modules/timetracker/views.html#logout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#timetracker.views.logout" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple logout function</p>
<p>This function will delete a session id from the session dictionary so that
the user will need to log back in order to access the same pages.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>request</strong> &#8211; Automatically passed contains a map of the httprequest</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A HttpResponse object which is passed to the browser.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="timetracker.views.user_view">
<tt class="descclassname">timetracker.views.</tt><tt class="descname">user_view</tt><big>(</big><em>request</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/timetracker/views.html#user_view"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#timetracker.views.user_view" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a calendar based on the URL it receives.
For example: domain.com/calendar/{year}/{month}/{day},
also takes a day just in case you want to add a particular
view for a day, for example. Currently a day-level is not
in-use.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Note :</th><td class="field-body"><p class="first">The generated HTML should be pretty printed</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>request</strong> &#8211; Automatically passed contains a map of the httprequest</li>
<li><strong>year</strong> &#8211; The year that the view will be rendered with, default is
the current year.</li>
<li><strong>month</strong> &#8211; The month that the view will be rendered with, default is
the current month.</li>
<li><strong>day</strong> &#8211; The day that the view will be rendered with, default is
the current day</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A HttpResponse object which is passed to the browser.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-timetracker.settings">
<span id="development-server-settings-module"></span><h1>Development Server Settings module<a class="headerlink" href="#module-timetracker.settings" title="Permalink to this headline">¶</a></h1>
<p>This module is used for the DJANGO_SETTINGS_MODULE when the development server
is being used. This is because there are different levels of logging and the
location of the logs is completely different from when the production server
is being used.</p>
<p>Another reason is that usually (and you should be) the production server is
being run as a daemon user (http user in the case of Apache) and this causes
problems for certain portions of code, particularly logging or anything that
requires write access to the filesystem, thus, the separation of production
settings and the development one.</p>
<p>TODO: Create a base settings module and import attributes from there,
overriding when we need to.</p>
</div>
<div class="section" id="module-timetracker.apache_settings">
<span id="apache-settings-module"></span><h1>Apache Settings module<a class="headerlink" href="#module-timetracker.apache_settings" title="Permalink to this headline">¶</a></h1>
<p>This module is used for the DJANGO_SETTINGS_MODULE for when apache is being
used. This is because there are different levels of logging when using the dev
server and when using the apache server. They also are running under different
user profiles and therefore have different filesystem access rights. On
Windows this isn&#8217;t a problem but on Linux it makes it a lot easier to use two
separate settings files.</p>
<p>TODO: Create a base settings module and import attributes from there,
overriding when we need to.</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">platform:</th><td class="field-body">All</td>
</tr>
<tr class="field-even field"><th class="field-name">synopsis:</th><td class="field-body">Module which contains settings for running the app on Apache</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">View Module</a></li>
<li><a class="reference internal" href="#module-timetracker.settings">Development Server Settings module</a></li>
<li><a class="reference internal" href="#module-timetracker.apache_settings">Apache Settings module</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to Timetracker&#8217;s documentation!</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/code.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to Timetracker’s documentation!"
             >previous</a> |</li>
        <li><a href="index.html">Timetracker 1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Aaron France.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>